let restrict f p x = if p x then Some (f x) else None;;
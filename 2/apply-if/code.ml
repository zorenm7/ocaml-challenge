let apply_if p f x = if p x then f x else x;;